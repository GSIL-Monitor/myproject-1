"use strict";$(function(){$("#search").on("click",function(){a("/admin/getMachinePageList",1);return false;}).trigger("click");delAllSelect("snFile","/admin/deletePath?type=2");
$("#dataList").on("click",'a[name="zip"]',function(){var b=this.href;$.getJSON(b,function(c){if(c.code=="N00000"){layer.msg(c.message+'&nbsp;&nbsp;&nbsp;&nbsp;<a href="'+c.data+'" target="_blank" title="下载">下载文件</a>',{icon:1,time:5000});
setTimeout(function(){window.open(c.data);},5000);}else{layer.msg(c.message,{icon:2,time:1000});}});return false;});$("#zipList").on("click",function(){var c=this.href,e=$('input[name="selDel"]').length,b=$('input[name="selDel"]:checked'),d=[];
if(b.length<=0){layer.msg("您还未选择要压缩的数据!",{icon:2,time:1000});return false;}if(e==b.length){c+="&isAll=1";}else{b.each(function(){var f=$(this);d.push(f.attr("value"));
});c+=d.toString();}layer.confirm("压缩可能要等待几分钟，是否开始？",function(f){$.ajax({type:"get",url:c,dataType:"json",success:function(g){if(g.code=="N00000"){layer.msg(g.message+'&nbsp;&nbsp;&nbsp;&nbsp;<a href="'+g.data+'" target="_blank" title="下载">下载文件</a>',{icon:1,time:5000});
setTimeout(function(){window.open(g.data);},5000);}else{layer.msg(g.message,{icon:2,time:1000});}},error:function(g,i,h){layer.msg("网络错误!",{icon:2,time:1000});
},});});return false;});function a(c,b){if(!c){return false;}var d=b||1;var e=$("#sn").val();$.ajax({type:"POST",url:c,data:{sn:e,pageIndex:d,pageSize:CONFIG.pageSize},success:function(f){var f=JSON.parse(f),h=f.data;
if(f.code=="N00000"&&h!=undefined){$("#listCount").text(h.totalCount);laypage({cont:$("#page"),skip:true,groups:6,pages:h.totalPages,curr:d||1,jump:function(i,j){if(!j){a(c,i.curr);
}}});if(h.data!=undefined){var g=h.data;$("#dataList").dataTable({autoWidth:true,info:false,paging:false,ordering:false,searching:false,deferRender:true,destroy:true,data:g,columns:[{data:"machineId",render:function(j,i,l,k){return'<input type="checkbox" value="'+l.sn+'" name="selDel">';
}},{data:"sn"},{render:function(j,i,l,k){return(l.sn===undefined)?"":'<a title="查看" href="javascript:;" onclick="pageFullShow (\'日志查看\',\'/admin/logPageList?sn='+l.sn+"')\">查看</a>";
}},{render:function(j,i,l,k){return(l.sn===undefined)?"":'<a title="查看" href="javascript:;" onclick="pageFullShow (\'日志查看\',\'/admin/machineLogPageList?sn='+l.sn+"')\">查看</a>";
}},{render:function(j,i,l,k){return(l.sn===undefined)?"":'<a title="查看" href="javascript:;" onclick="pageFullShow (\'清扫记录查看\',\'/admin/getPath?sn='+l.sn+"')\">查看</a>";
}},{render:function(j,i,l,k){return'<a href="/admin/getPathZip?sn='+l.sn+'" name="zip" title="压缩" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe641;</i></a> <a title="删除" href="javascript:;" onclick="delSelect(this,\'/admin/deletePath?type=2&snFile='+l.sn+'\')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6e2;</i></a>';
}}],createdRow:function(k,j,i){$(k).addClass("text-c");}});}}else{layer.msg(f.message,{icon:1,time:1000});}},error:function(f,h,g){layer.msg("网络错误!",{icon:1,time:1000});
console.error(f,h,g);}});}});