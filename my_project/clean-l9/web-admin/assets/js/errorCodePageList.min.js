"use strict";$(function(){$("#search").on("click",function(){loadDataList("/admin/getErrorCodePageList",1);return false}).trigger("click");delAllSelect("errorCodeIdList","/admin/deleteErrorCodeList");function loadDataList(urlString,page){if(!urlString){return false}var curr=page||1;var companyId=$("#companyId").val();$.ajax({"type":"POST","url":urlString,"data":{companyId:companyId,pageIndex:curr,pageSize:CONFIG.pageSize},success:function(result){var result=JSON.parse(result),data=result.data;if(result.code=="N00000"&&data!=undefined){$("#listCount").text(data.totalCount);laypage({cont:$("#page"),skip:true,groups:6,pages:data.totalPages,curr:curr||1,jump:function(obj,first){if(!first){loadDataList(urlString,obj.curr)}}});if(data.data!=undefined){var tableData=data.data;$("#dataList").dataTable({"autoWidth":true,"info":false,"paging":false,"ordering":false,"searching":false,"deferRender":true,"destroy":true,"data":tableData,"columns":[{"data":"errorCodeId","render":function(data,type,row,meta){return'<input type="checkbox" value="'+row.errorCodeId+'" name="selDel">'}},{"data":"code"},{"data":"errType","render":function(data,type,row,meta){return(row.errType!=undefined)?row.errType:""}},{"data":"chMsg","render":function(data,type,row,meta){return(row.chMsg!=undefined)?row.chMsg:""}},{"data":"enMsg","render":function(data,type,row,meta){return(row.enMsg!=undefined)?row.enMsg:""}},{"data":"koMsg","render":function(data,type,row,meta){return(row.koMsg!=undefined)?row.koMsg:""}},{"data":"companyName","render":function(data,type,row,meta){return(row.companyName==undefined)?"通用":row.companyName}},{"data":"createTime","render":function(data,type,row,meta){return(row.createTime).toString().replace(/T/g," ").replace(/\+[\d]{4}/,"")}},{"render":function(data,type,row,meta){return'<a title="编辑" href="javascript:;" onclick="pageFullShow (\'错误码编辑\',\'/admin/editErrorCode?errorCodeId='+row.errorCodeId+"','"+row.adminUserName+'\')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6df;</i></a> <a title="删除" href="javascript:;" onclick="delSelect(this,\'/admin/deleteErrorCodeList?errorCodeIdList='+row.errorCodeId+'\')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6e2;</i></a>'}}],"createdRow":function(row,data,index){$(row).addClass("text-c")}})}}else{layer.msg(result.message,{icon:1,time:1000})}},error:function(XMLHttpRequest,textStatus,errorThrown){layer.msg("网络错误!",{icon:1,time:1000});console.error(XMLHttpRequest,textStatus,errorThrown)}})}var dis=false;$("#update").on("click",function(){var errorCodeVersionId=$("#errorCodeVersionId").val(),version=$("#version").val();var postUrl=!errorCodeVersionId?"/admin/addErrorCodeVersion":"/admin/editErrorCodeVersion";if(!version){layer.msg("请填写版本号!",{icon:1,time:1000});return false}dis=true;$.ajax({type:"post",data:{"errorCodeVersionId":errorCodeVersionId,"version":version},url:postUrl,success:function(data){var data=JSON.parse(data);if(data.code=="N00000"){layer.msg("保存成功!",{icon:1,time:1000});if(!errorCodeVersionId){setTimeout(function(){$(".btn-refresh").trigger("click")},1200)}}else{layer.msg(data.message,{icon:2,time:1000})}dis=false},error:function(XmlHttpRequest,textStatus,errorThrown){layer.msg("网络错误!",{icon:2,time:1000});dis=false}})})});