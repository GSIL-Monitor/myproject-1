"use strict";$(function(){delAllSelect("whiteGroupSnIdList","/admin/deleteWhiteGroupSnList");$("#search").on("click",function(){a("/admin/getWhiteGroupSnPageList",1);
}).trigger("click");$("#uploadWhiteGroupSnExcel").on("click",function(){$('input[name="file"]').click();return false;});function a(d,c){if(!d){return false;
}var e=c||1;var b=$("#whiteGroupId").val(),f=$("#sn").val();$.ajax({type:"POST",url:d,data:{whiteGroupId:b,sn:f,pageIndex:e,pageSize:CONFIG.pageSize},success:function(g){var g=JSON.parse(g),i=g.data;
if(g.code=="N00000"&&i!=undefined){$("#listCount").text(i.length);laypage({cont:$("#page"),skip:true,groups:6,pages:1,curr:e||1,jump:function(j,k){if(!k){a(d,j.curr);
}}});if(i!=undefined){var h=i;$("#dataList").dataTable({autoWidth:true,info:false,paging:false,ordering:false,searching:false,deferRender:true,destroy:true,data:h,columns:[{data:"whiteGroupSnId",render:function(k,j,m,l){return'<input type="checkbox" value="'+m.whiteGroupSnId+'" name="selDel">';
}},{data:"sn"},{data:"noteName",render:function(k,j,m,l){return(m.noteName===undefined)?"":m.noteName;}},{data:"createTime",render:function(k,j,m,l){return(m.createTime).toString().replace(/T/g," ").replace(/\+[\d]{4}/,"");
}},{render:function(k,j,m,l){return'<a title="编辑" href="javascript:;" onclick="snsModeShow(\'编辑\',\'/admin/editWhiteGroupSnSubmit?whiteGroupSnId='+m.whiteGroupSnId+"','"+m.sn+"','"+m.noteName+'\')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6df;</i></a> <a title="删除" href="javascript:;" onclick="delSelect(this,\'/admin/deleteWhiteGroupSnList?whiteGroupSnIdList='+m.whiteGroupSnId+'\')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6e2;</i></a>';
}}],createdRow:function(l,k,j){$(l).addClass("text-c");}});}}else{layer.msg(g.message,{icon:1,time:1000});}},error:function(g,i,h){layer.msg("网络错误!",{icon:1,time:1000});
console.error(g,i,h);}});}});var dis=false;function snsModeShow(g,b,f,e){var c=$("#noteName"),d=$("#sn1"),a=$("#whiteGroupId");d.val(f!=undefined?f:"");
c.val(e!=undefined?e:"");layer.open({type:1,area:["800px","310px"],fix:false,maxmin:true,shade:0.4,title:g,content:$("#addSns"),success:function(h,i){$("#reset").on("click",function(){layer.close(i);
return false;});$("#form").validate({rules:{sn1:{required:true},whiteGroupId:{required:true}},onkeyup:false,focusCleanup:true,success:"valid",submitHandler:function(l){var k=c.val(),m=d.val(),j=a.val();
if(dis){return false;}dis=true;$.ajax({type:"post",data:{noteName:k,sn:m,whiteGroupId:j},url:b,success:function(n){var n=JSON.parse(n);if(n.code=="N00000"){layer.msg("保存成功!",{icon:1,time:1000});
setTimeout(function(){location.replace(location.href);},1200);}else{layer.msg(n.message,{icon:2,time:1000});}dis=false;},error:function(n,p,o){layer.msg("网络错误!",{icon:2,time:1000});
dis=false;}});}});}});return false;}$(function(){var b=$("#fileList"),a=$("#whiteGroupId").val(),c;c=WebUploader.create({auto:true,swf:"/assets/lib/webuploader/0.1.5/Uploader.swf",server:"/admin/uploadWhiteGroupSnExcel?whiteGroupId="+a,duplicate:true,fileVar:"file",pick:{id:"#filePicker",name:"file",multiple:false},resize:false,accept:{title:"Files",extensions:"csv,xls,xlsx",mimeTypes:"application/vnd.ms-excel"}});
c.on("fileQueued",function(d){var e=$('<div id="'+d.id+'" class="item"><p class="state">等待上传...</p></div>');b.append(e);layer.msg("准备上传啦..");});c.on("uploadProgress",function(f,d){var g=$("#"+f.id),e=g.find(".progress-box .sr-only");
if(!e.length){e=$('<div class="progress-box"><span class="progress-bar radius"><span class="sr-only" style="width:0%"></span></span></div>').appendTo(g).find(".sr-only");
}g.find(".state").text("上传中..");e.css("width",d*100+"%");});c.on("uploadSuccess",function(e,d){var f=JSON.parse(d._raw);layer.msg(f.message,{time:2*1000});
if(f.code=="N00000"){location.replace(location.href);}});c.on("uploadError",function(d){$("#"+d.id).addClass("upload-state-error").find(".state").text("上传出错");
layer.msg("上传出错",{icon:2,time:2*1000});});c.on("uploadComplete",function(d){$("#"+d.id).find(".progress-box").fadeOut();layer.msg("正在操作..");});});